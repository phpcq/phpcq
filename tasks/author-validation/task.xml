<project name="phpcq.task.author-validation">
    <import file="../macrodefs.xml" />
    <property file="${phpcq.basedir}/tasks/author-validation/default.properties"/>
    <target name="-check-author-validation.is-available" unless="phpcq.task.author-validation.bin">
        <find-file-in-path
            name="check-author.php"
            property="phpcq.task.author-validation.bin"
            alternativepath="${phpcq.bin.author-validation}"
        />
    </target>
    <target name="author-validation" depends="-check-author-validation.is-available" if="phpcq.task.author-validation.bin">
        <script language="javascript"><![CDATA[
            project.setProperty(
                'author-validation.arguments',
                (project.getProperty('author-validation.php-files') ? '--php-files' : '') +
                (project.getProperty('author-validation.composer')  ? '--composer' : '') +
                (project.getProperty('author-validation.bower')     ? '--bower' : '') +
                (project.getProperty('author-validation.packages')  ? '--packages' : '')
            );
        ]]></script>
        <exec dir="${basedir}" executable="${phpcq.php-cli.bin}" failonerror="true" taskname="author-validation">
            <arg value="${phpcq.task.author-validation.bin}"/>
            <arg line="${author-validation.arguments}"/>
            <arg value="${basedir}"/>
        </exec>
    </target>
</project>
